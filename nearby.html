<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nearby Tailors</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f7f0fb 0%, #e8d5f2 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    h1 {
      color: #6a0dad;
      margin-bottom: 20px;
      font-size: 2.5rem;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }

    .location-controls {
      max-width: 600px;
      margin: 0 auto 30px auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .location-status {
      background: rgba(255, 255, 255, 0.9);
      padding: 15px;
      border-radius: 15px;
      text-align: center;
      font-weight: 600;
      color: #6a0dad;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 15px rgba(106, 13, 173, 0.1);
    }

    .location-status.loading {
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
      color: #d63031;
    }

    .location-status.success {
      background: linear-gradient(135deg, #d1f2eb 0%, #a3e4d7 100%);
      color: #27ae60;
    }

    .location-status.error {
      background: linear-gradient(135deg, #fadbd8 0%, #f1948a 100%);
      color: #e74c3c;
    }

    .search-container {
      position: relative;
      display: flex;
      gap: 10px;
    }

    .search-input {
      flex: 1;
      padding: 15px 20px;
      border: 2px solid rgba(106, 13, 173, 0.2);
      border-radius: 25px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      color: #333;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: #6a0dad;
      background: white;
      box-shadow: 0 0 0 3px rgba(106, 13, 173, 0.1);
    }

    .search-input::placeholder {
      color: #999;
      font-style: italic;
    }

    .location-btn {
      padding: 15px 25px;
      background: linear-gradient(135deg, #6a0dad 0%, #8a4bb8 100%);
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      white-space: nowrap;
      box-shadow: 0 4px 15px rgba(106, 13, 173, 0.3);
    }

    .location-btn:hover {
      background: linear-gradient(135deg, #5a2478 0%, #7a3fa5 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(106, 13, 173, 0.4);
    }

    .location-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .filters {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.7);
      border: 2px solid rgba(106, 13, 173, 0.2);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #6a0dad;
      font-weight: 600;
    }

    .filter-btn.active, .filter-btn:hover {
      background: #6a0dad;
      color: white;
      border-color: #6a0dad;
    }

    .tailor-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .tailor-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(106, 13, 173, 0.1);
      text-align: center;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }

    .tailor-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(106, 13, 173, 0.2);
    }

    .tailor-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .tailor-card:hover::before {
      left: 100%;
    }

    .tailor-card img {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 15px;
    }

    .tailor-name {
      font-size: 18px;
      font-weight: bold;
      color: #6a0dad;
      margin-bottom: 5px;
    }

    .tailor-location {
      color: #555;
      font-size: 14px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    .tailor-distance {
      background: linear-gradient(135deg, #6a0dad 0%, #8a4bb8 100%);
      color: white;
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 8px;
      display: inline-block;
    }

    .tailor-rating {
      color: #f39c12;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .contact-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .contact-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .call-btn {
      background: #27ae60;
      color: white;
    }

    .call-btn:hover {
      background: #219a52;
    }

    .directions-btn {
      background: #3498db;
      color: white;
    }

    .directions-btn:hover {
      background: #2980b9;
    }

    .no-results {
      text-align: center;
      color: #6a0dad;
      font-size: 18px;
      margin-top: 50px;
      padding: 30px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }

    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(106, 13, 173, 0.3);
      border-radius: 50%;
      border-top-color: #6a0dad;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .search-container {
        flex-direction: column;
      }
      
      .location-btn {
        text-align: center;
      }
      
      .filters {
        justify-content: center;
        gap: 10px;
      }
      
      .filter-btn {
        padding: 8px 16px;
        font-size: 14px;
      }
      
      h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Nearby Tailors</h1>
    
    <div class="location-controls">
      <div id="locationStatus" class="location-status">
        üìç Enable location to find nearby tailors
      </div>
      
      <div class="search-container">
        <input 
          type="text" 
          id="searchInput" 
          class="search-input" 
          placeholder="Search by location or tailor name..."
        >
        <button id="locationBtn" class="location-btn" onclick="getCurrentLocation()">
          üìç Use My Location
        </button>
      </div>
    </div>

    <div class="filters">
      <button class="filter-btn active" onclick="filterByRating('all')">All Tailors</button>
      <button class="filter-btn" onclick="filterByRating('4+')">4+ Stars</button>
      <button class="filter-btn" onclick="filterByRating('5')">5 Stars</button>
      <button class="filter-btn" onclick="sortByDistance()">Sort by Distance</button>
    </div>
  </div>

  <div id="tailorList" class="tailor-list">
    <!-- Tailors will be populated by JavaScript -->
  </div>

  <div id="noResults" class="no-results" style="display: none;">
    No tailors found matching your criteria.
  </div>

  <script>
    // Tailor data with coordinates (latitude, longitude)
    const tailors = [
      {
        id: 1,
        name: "Stitch & Style",
        location: "R.S. Puram, Coimbatore",
        rating: 4.0,
        coordinates: { lat: 11.0168, lng: 76.9558 },
        phone: "+91 9876543210",
        image: "https://via.placeholder.com/300x200?text=Stitch+%26+Style"
      },
      {
        id: 2,
        name: "Perfect Fit Tailors",
        location: "Gandhipuram, Coimbatore",
        rating: 4.8,
        coordinates: { lat: 11.0183, lng: 76.9725 },
        phone: "+91 9876543211",
        image: "https://via.placeholder.com/300x200?text=Perfect+Fit+Tailors"
      },
      {
        id: 3,
        name: "Classic Cuts",
        location: "Race Course, Coimbatore",
        rating: 4.2,
        coordinates: { lat: 11.0041, lng: 76.9597 },
        phone: "+91 9876543212",
        image: "https://via.placeholder.com/300x200?text=Classic+Cuts"
      },
      {
        id: 4,
        name: "Smart Stitch",
        location: "Saibaba Colony, Coimbatore",
        rating: 3.9,
        coordinates: { lat: 11.0510, lng: 76.9638 },
        phone: "+91 9876543213",
        image: "https://via.placeholder.com/300x200?text=Smart+Stitch"
      },
      {
        id: 5,
        name: "Thread & Needle",
        location: "Vadavalli, Coimbatore",
        rating: 5.0,
        coordinates: { lat: 11.0214, lng: 76.9045 },
        phone: "+91 9876543214",
        image: "https://via.placeholder.com/300x200?text=Thread+%26+Needle"
      },
      {
        id: 6,
        name: "Elegant Tailors",
        location: "Kuniyamuthur, Coimbatore",
        rating: 4.3,
        coordinates: { lat: 10.9924, lng: 76.9510 },
        phone: "+91 9876543215",
        image: "https://via.placeholder.com/300x200?text=Elegant+Tailors"
      },
      {
        id: 7,
        name: "The Fashion Stitch",
        location: "Singanallur, Coimbatore",
        rating: 3.7,
        coordinates: { lat: 11.0257, lng: 77.0344 },
        phone: "+91 9876543216",
        image: "https://via.placeholder.com/300x200?text=The+Fashion+Stitch"
      },
      {
        id: 8,
        name: "Urban Threads",
        location: "Ganapathy, Coimbatore",
        rating: 4.1,
        coordinates: { lat: 11.0618, lng: 76.9902 },
        phone: "+91 9876543217",
        image: "https://via.placeholder.com/300x200?text=Urban+Threads"
      },
      {
        id: 9,
        name: "Style Hub",
        location: "Thudiyalur, Coimbatore",
        rating: 3.5,
        coordinates: { lat: 11.0770, lng: 76.8718 },
        phone: "+91 9876543218",
        image: "https://via.placeholder.com/300x200?text=Style+Hub"
      },
      {
        id: 10,
        name: "Chic Tailoring",
        location: "Podanur, Coimbatore",
        rating: 4.9,
        coordinates: { lat: 10.9986, lng: 76.9719 },
        phone: "+91 9876543219",
        image: "https://via.placeholder.com/300x200?text=Chic+Tailoring"
      }
    ];

    let userLocation = null;
    let filteredTailors = [...tailors];

    // Calculate distance between two points using Haversine formula
    function calculateDistance(lat1, lon1, lat2, lon2) {
      const R = 6371; // Radius of the Earth in kilometers
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a = 
        Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
        Math.sin(dLon/2) * Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      const distance = R * c;
      return distance;
    }

    // Get user's current location
    function getCurrentLocation() {
      const locationBtn = document.getElementById('locationBtn');
      const locationStatus = document.getElementById('locationStatus');
      
      locationBtn.disabled = true;
      locationBtn.innerHTML = '<span class="loading-spinner"></span> Getting Location...';
      locationStatus.className = 'location-status loading';
      locationStatus.innerHTML = 'üìç Getting your location...';

      if (!navigator.geolocation) {
        showError('Geolocation is not supported by this browser.');
        return;
      }

      navigator.geolocation.getCurrentPosition(
        (position) => {
          userLocation = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
          
          locationStatus.className = 'location-status success';
          locationStatus.innerHTML = '‚úÖ Location found! Showing nearby tailors';
          locationBtn.innerHTML = 'üìç Update Location';
          locationBtn.disabled = false;
          
          calculateDistancesAndSort();
        },
        (error) => {
          let errorMessage = 'Unable to get your location. ';
          switch(error.code) {
            case error.PERMISSION_DENIED:
              errorMessage += 'Please allow location access.';
              break;
            case error.POSITION_UNAVAILABLE:
              errorMessage += 'Location information unavailable.';
              break;
            case error.TIMEOUT:
              errorMessage += 'Location request timed out.';
              break;
            default:
              errorMessage += 'An unknown error occurred.';
              break;
          }
          showError(errorMessage);
        },
        {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 300000
        }
      );
    }

    function showError(message) {
      const locationBtn = document.getElementById('locationBtn');
      const locationStatus = document.getElementById('locationStatus');
      
      locationStatus.className = 'location-status error';
      locationStatus.innerHTML = '‚ùå ' + message;
      locationBtn.innerHTML = 'üìç Try Again';
      locationBtn.disabled = false;
    }

    // Calculate distances and sort tailors
    function calculateDistancesAndSort() {
      if (!userLocation) return;

      tailors.forEach(tailor => {
        tailor.distance = calculateDistance(
          userLocation.lat, 
          userLocation.lng, 
          tailor.coordinates.lat, 
          tailor.coordinates.lng
        );
      });

      // Sort by distance (nearest first)
      tailors.sort((a, b) => a.distance - b.distance);
      filteredTailors = [...tailors];
      displayTailors();
    }

    // Generate star rating HTML
    function generateStars(rating) {
      const fullStars = Math.floor(rating);
      const hasHalfStar = rating % 1 !== 0;
      let stars = '';
      
      for (let i = 0; i < fullStars; i++) {
        stars += '‚≠ê';
      }
      
      if (hasHalfStar) {
        stars += '‚≠ê';
      }
      
      const emptyStars = 5 - Math.ceil(rating);
      for (let i = 0; i < emptyStars; i++) {
        stars += '‚òÜ';
      }
      
      return stars;
    }

    // Display tailors
    function displayTailors() {
      const tailorList = document.getElementById('tailorList');
      const noResults = document.getElementById('noResults');
      
      if (filteredTailors.length === 0) {
        tailorList.style.display = 'none';
        noResults.style.display = 'block';
        return;
      }
      
      tailorList.style.display = 'grid';
      noResults.style.display = 'none';
      
      tailorList.innerHTML = filteredTailors.map(tailor => {
        const distanceHTML = tailor.distance ? 
          `<div class="tailor-distance">üìç ${tailor.distance.toFixed(1)} km away</div>` : '';
        
        return `
          <div class="tailor-card">
            <img src="${tailor.image}" alt="${tailor.name}">
            <div class="tailor-name">${tailor.name}</div>
            <div class="tailor-location">
              üìç ${tailor.location}
            </div>
            ${distanceHTML}
            <div class="tailor-rating">${generateStars(tailor.rating)} (${tailor.rating})</div>
            <div class="contact-buttons">
              <a href="tel:${tailor.phone}" class="contact-btn call-btn">üìû Call</a>
              <a href="https://www.google.com/maps/dir/?api=1&destination=${tailor.coordinates.lat},${tailor.coordinates.lng}" 
                 target="_blank" class="contact-btn directions-btn">üó∫Ô∏è Directions</a>
            </div>
          </div>
        `;
      }).join('');
    }

    // Search functionality
    function searchTailors() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      
      if (searchTerm === '') {
        filteredTailors = [...tailors];
      } else {
        filteredTailors = tailors.filter(tailor => 
          tailor.name.toLowerCase().includes(searchTerm) ||
          tailor.location.toLowerCase().includes(searchTerm)
        );
      }
      
      displayTailors();
    }

    // Filter by rating
    function filterByRating(criteria) {
      // Update active button
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      if (criteria === 'all') {
        filteredTailors = [...tailors];
      } else if (criteria === '4+') {
        filteredTailors = tailors.filter(tailor => tailor.rating >= 4.0);
      } else if (criteria === '5') {
        filteredTailors = tailors.filter(tailor => tailor.rating === 5.0);
      }
      
      displayTailors();
    }

    // Sort by distance
    function sortByDistance() {
      if (!userLocation) {
        alert('Please enable location first to sort by distance!');
        return;
      }
      
      // Update active button
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      filteredTailors.sort((a, b) => a.distance - b.distance);
      displayTailors();
    }

    // Event listeners
    document.getElementById('searchInput').addEventListener('input', searchTailors);

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      displayTailors();
    });

    // Auto-get location on page load (optional)
    window.addEventListener('load', function() {
      // Uncomment the line below if you want to automatically request location on page load
      // getCurrentLocation();
    });
  </script>
</body>
</html>